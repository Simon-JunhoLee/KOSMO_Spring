<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>사용자등록</title>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
	<h1>사용자등록</h1>
	<form method="post" name="frm">
		<input name="uid" value="young" placeholder="아이디"/><hr>
		<input name="upass" value="pass" placeholder="비밀번호" type="password"/><hr>
		<input name="uname" value="김영훈" placeholder="이름"/> <br><br>
		<button>등록</button> 
		<button type="reset">취소</button>
	</form>
</body>

<script>
	$(frm).on("submit", function(e){
		e.preventDefault();
		const uid = $(frm.uid).val();
		const upass = $(frm.upass).val();
		const uname = $(frm.uname).val();
		if(uid == "" || upass == "" || uname == ""){
			Swal.fire({
			  title: "입력 에러",
			  text: "모든 데이터를 입력하세요!",
			  icon: "error"
			});
			return;
		}
		Swal.fire({
			  title: "회원가입 하시겠습니까?",
			  showCancelButton: true,
			  confirmButtonText: "Confirm",
			  icon:"info",
			}).then((result) => {
			  /* Read more about isConfirmed, isDenied below */
			  if (result.isConfirmed) {				  
				$.ajax({
					type:"post",
					url:"/users/insert",
					data:{uid, upass, uname},
					success:function(){
						Swal.fire({
						  title: "가입성공",
						  text: "",
						  icon: "success"
						}).then((result) => {							
							location.href="/users/list";
						});
					}
				});
			  }else{
				  return;
			  }
			});
	});
</script>
</html>