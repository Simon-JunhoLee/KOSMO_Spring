<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.CouMapper">
   <select id="list" resultType="com.example.domain.CouVO">
   		select * from view_cou
   		<if test="key == 'lcode'">   		
			where lcode like #{word}
	 	</if>
	 	<if test="key == 'lname'">   		
			where lname like #{word}
	 	</if>
	 	<if test="key == 'pname'">   		
			where pname like #{word}
	 	</if>
	 	<if test="key == 'dept'">   		
			where dept like #{word}
	 	</if>
	 	order by lcode desc
   		limit #{start}, #{size}
   </select>
   
   <select id="total" resultType="int">
   		select count(*) total
   		from courses
   		<if test="key == 'lcode'">   		
			where lcode like #{word}
	 	</if>
	 	<if test="key == 'lname'">   		
			where lname like #{word}
	 	</if>
	 	<if test="key == 'pname'">   		
			where pname like #{word}
	 	</if>
	 	<if test="key == 'dept'">   		
			where dept like #{word}
	 	</if>
   </select>
   
   <select id="getCode" resultType="string" statementType="CALLABLE">
   		{call getlcode(#{dept})}
   </select>
   
   <insert id="insert">
   		insert into courses(lcode, lname, dept) 
   		values(#{lcode}, #{lname}, #{dept})
   </insert>
   
   <select id="read" resultType="com.example.domain.CouVO">
   		select * from view_cou
   		where lcode=#{lcode}
   </select>
   
   <update id="update">
   		update courses set lname=#{lname}, hours=#{hours}, room=#{room}, instructor=#{instructor}, capacity=#{capacity}
   		where lcode=#{lcode}
   </update>
   
   <delete id="delete">
   		delete from courses where lcode=#{lcode}
   </delete>
</mapper>